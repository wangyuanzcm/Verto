# 环境配置检查清单

## 📋 部署前检查清单

### 🖥️ 系统要求检查

#### Windows系统要求
- [ ] **操作系统**: Windows 10 Pro/Enterprise (版本 1903 或更高)
- [ ] **内存**: 至少 8GB RAM (推荐 16GB)
- [ ] **存储**: 至少 50GB 可用磁盘空间
- [ ] **CPU**: 支持虚拟化的 64 位处理器
- [ ] **网络**: 稳定的互联网连接

#### 虚拟化检查
```bash
# 检查虚拟化是否启用
# 任务管理器 -> 性能 -> CPU -> 虚拟化: 已启用

# 或使用PowerShell检查
Get-ComputerInfo | Select-Object HyperVRequirementVirtualizationFirmwareEnabled
```

#### BIOS设置检查
- [ ] **Intel VT-x** 或 **AMD-V** 已启用
- [ ] **Hyper-V** 已启用（如果使用WSL2）
- [ ] **安全启动** 配置正确

### 🐳 Docker环境检查

#### Docker Desktop安装
- [ ] **Docker Desktop** 已安装 (版本 4.0 或更高)
- [ ] **WSL2** 后端已启用（推荐）
- [ ] **Docker Compose** 已安装 (版本 2.0 或更高)

#### Docker配置验证
```bash
# 检查Docker版本
docker --version
docker-compose --version

# 检查Docker服务状态
docker info

# 测试Docker功能
docker run hello-world
```

#### Docker资源配置
- [ ] **内存**: 至少分配 4GB 给 Docker
- [ ] **CPU**: 至少分配 2 个 CPU 核心
- [ ] **磁盘**: 至少 20GB 磁盘空间
- [ ] **文件共享**: 项目目录已添加到共享列表

### 🔧 开发工具检查

#### 必需工具
- [ ] **Git** 已安装并配置
- [ ] **Node.js** (版本 16 或更高)
- [ ] **pnpm** 包管理器
- [ ] **Java JDK** (版本 8 或更高)
- [ ] **Maven** 构建工具

#### 工具版本验证
```bash
# 检查工具版本
git --version
node --version
pnpm --version
java -version
mvn --version
```

#### IDE配置
- [ ] **VS Code** 或其他IDE已安装
- [ ] **Docker扩展** 已安装
- [ ] **Git扩展** 已安装
- [ ] **Vue.js扩展** 已安装（前端开发）
- [ ] **Java扩展** 已安装（后端开发）

---

## 🚀 部署配置检查

### 📁 项目结构检查

#### 必需文件
- [ ] `docker-compose-devops.yml` - DevOps服务配置
- [ ] `.env.devops` - 环境变量配置
- [ ] `start-devops.bat` - 启动脚本
- [ ] `stop-devops.bat` - 停止脚本
- [ ] `devops-status.bat` - 状态检查脚本

#### 目录结构
```
Verto/
├── docker-compose-devops.yml
├── .env.devops
├── start-devops.bat
├── stop-devops.bat
├── devops-status.bat
├── gitlab/
│   ├── config/
│   ├── logs/
│   ├── data/
│   └── gitlab.rb
├── jenkins/
│   ├── Dockerfile
│   └── plugins.txt
├── jenkins_home/
├── mysql/
│   └── data/
└── redis/
    └── data/
```

#### 权限检查
- [ ] 当前用户对项目目录有**完全控制**权限
- [ ] Docker有权限访问项目目录
- [ ] 防火墙允许Docker端口通信

### 🔐 安全配置检查

#### 密码和密钥
- [ ] MySQL root密码已设置
- [ ] MySQL用户密码已设置
- [ ] GitLab root密码已记录
- [ ] Jenkins管理员密码已设置
- [ ] SSH密钥已生成（如需要）

#### 网络安全
- [ ] 防火墙规则已配置
- [ ] 端口访问控制已设置
- [ ] SSL证书已配置（生产环境）
- [ ] 访问日志已启用

### 🌐 网络配置检查

#### 端口分配
- [ ] **8080**: GitLab HTTP端口
- [ ] **8081**: Jenkins HTTP端口
- [ ] **3306**: MySQL数据库端口
- [ ] **6379**: Redis缓存端口
- [ ] **22**: SSH端口（如需要）

#### 端口冲突检查
```bash
# 检查端口占用情况
netstat -ano | findstr :8080
netstat -ano | findstr :8081
netstat -ano | findstr :3306
netstat -ano | findstr :6379
```

#### 网络连通性测试
```bash
# 测试外网连接
ping google.com
ping docker.io

# 测试DNS解析
nslookup docker.io
nslookup github.com
```

---

## ⚙️ 配置文件检查

### 🐳 Docker Compose配置

#### 语法检查
```bash
# 验证docker-compose.yml语法
docker-compose -f docker-compose-devops.yml config

# 检查环境变量
docker-compose -f docker-compose-devops.yml --env-file .env.devops config
```

#### 服务配置检查
- [ ] **GitLab**: 镜像版本、端口映射、卷挂载
- [ ] **Jenkins**: 镜像版本、端口映射、卷挂载
- [ ] **MySQL**: 镜像版本、环境变量、数据持久化
- [ ] **Redis**: 镜像版本、配置文件、数据持久化

### 📝 环境变量配置

#### .env.devops文件检查
```bash
# 必需的环境变量
MYSQL_ROOT_PASSWORD=your_secure_password
MYSQL_DATABASE=verto
MYSQL_USER=verto
MYSQL_PASSWORD=your_secure_password

GITLAB_HTTP_PORT=8080
GITLAB_HTTPS_PORT=8443
GITLAB_SSH_PORT=2222

JENKINS_HTTP_PORT=8081
JENKINS_AGENT_PORT=50000

REDIS_PORT=6379
```

#### 变量验证
- [ ] 所有密码都是强密码（至少8位，包含字母数字特殊字符）
- [ ] 端口号没有冲突
- [ ] 数据库名称和用户名符合规范
- [ ] 路径使用正确的分隔符

### 🔧 应用配置检查

#### 前端配置 (jeecgboot-vue3)
- [ ] `package.json` 依赖版本正确
- [ ] `vite.config.js` 配置正确
- [ ] `.env` 文件配置正确
- [ ] API接口地址配置正确

#### 后端配置 (jeecg-boot)
- [ ] `application.yml` 配置正确
- [ ] 数据库连接配置正确
- [ ] Redis连接配置正确
- [ ] 日志配置正确

---

## 🧪 功能测试检查

### 🐳 Docker服务测试

#### 基础功能测试
```bash
# 测试Docker基础功能
docker run --rm hello-world

# 测试Docker Compose
docker-compose --version

# 测试镜像拉取
docker pull nginx:alpine
```

#### 网络测试
```bash
# 创建测试网络
docker network create test-network

# 测试容器间通信
docker run -d --name test1 --network test-network nginx:alpine
docker run --rm --network test-network alpine ping test1

# 清理测试资源
docker rm -f test1
docker network rm test-network
```

### 🚀 服务启动测试

#### 启动顺序测试
1. [ ] **MySQL** 首先启动并就绪
2. [ ] **Redis** 启动并就绪
3. [ ] **GitLab** 启动并完成初始化
4. [ ] **Jenkins** 启动并完成初始化

#### 服务健康检查
```bash
# 检查服务状态
docker-compose -f docker-compose-devops.yml ps

# 检查服务健康状态
docker-compose -f docker-compose-devops.yml exec gitlab gitlab-ctl status
docker-compose -f docker-compose-devops.yml exec jenkins java -version
```

### 🌐 Web界面测试

#### 访问测试
- [ ] **GitLab**: http://localhost:8080 可访问
- [ ] **Jenkins**: http://localhost:8081 可访问
- [ ] 登录页面正常显示
- [ ] 初始配置向导可用

#### 功能测试
- [ ] **GitLab**: 可以创建项目
- [ ] **Jenkins**: 可以创建任务
- [ ] **数据库**: 连接正常
- [ ] **缓存**: Redis连接正常

---

## 📊 性能基准检查

### 💻 系统资源基准

#### 内存使用基准
- [ ] **空闲状态**: < 2GB
- [ ] **启动后**: < 6GB
- [ ] **运行中**: < 8GB
- [ ] **峰值**: < 12GB

#### CPU使用基准
- [ ] **空闲状态**: < 5%
- [ ] **启动时**: < 80%
- [ ] **正常运行**: < 30%
- [ ] **构建时**: < 90%

#### 磁盘使用基准
- [ ] **初始安装**: < 5GB
- [ ] **运行数据**: < 10GB
- [ ] **日志文件**: < 1GB
- [ ] **总使用量**: < 20GB

### ⚡ 性能指标基准

#### 启动时间基准
- [ ] **MySQL**: < 30秒
- [ ] **Redis**: < 10秒
- [ ] **GitLab**: < 3分钟
- [ ] **Jenkins**: < 1分钟

#### 响应时间基准
- [ ] **GitLab首页**: < 2秒
- [ ] **Jenkins首页**: < 1秒
- [ ] **数据库查询**: < 100ms
- [ ] **API响应**: < 500ms

---

## 🔍 故障排除检查

### 🚨 常见问题检查

#### Docker相关问题
- [ ] Docker Desktop是否正常运行
- [ ] WSL2是否正确配置
- [ ] 虚拟化是否启用
- [ ] 内存分配是否足够

#### 网络相关问题
- [ ] 端口是否被占用
- [ ] 防火墙是否阻止连接
- [ ] DNS解析是否正常
- [ ] 代理设置是否正确

#### 权限相关问题
- [ ] 文件权限是否正确
- [ ] Docker权限是否足够
- [ ] 用户组是否正确
- [ ] 目录访问是否正常

### 🔧 诊断工具检查

#### 系统诊断命令
```bash
# 系统信息
systeminfo | findstr /C:"OS Name" /C:"Total Physical Memory"

# Docker信息
docker info
docker system df

# 网络信息
ipconfig /all
netstat -ano | findstr LISTEN
```

#### 日志检查
```bash
# Docker日志
docker logs gitlab-ce --tail 50
docker logs jenkins --tail 50

# 系统日志
# 事件查看器 -> Windows日志 -> 系统
```

---

## ✅ 部署完成确认

### 🎯 最终验证清单

#### 服务可用性
- [ ] 所有Docker容器正常运行
- [ ] GitLab Web界面可访问
- [ ] Jenkins Web界面可访问
- [ ] 数据库连接正常
- [ ] Redis缓存正常

#### 功能完整性
- [ ] 可以创建GitLab项目
- [ ] 可以创建Jenkins任务
- [ ] 可以执行构建
- [ ] 可以查看日志
- [ ] 数据持久化正常

#### 安全性
- [ ] 默认密码已更改
- [ ] 访问控制已配置
- [ ] 日志记录已启用
- [ ] 备份策略已制定

#### 文档完整性
- [ ] 部署文档已更新
- [ ] 操作手册已提供
- [ ] 故障排除指南已准备
- [ ] 联系方式已确认

### 📋 交付清单

#### 交付物
- [ ] **部署包**: 包含所有配置文件
- [ ] **操作手册**: 详细的使用说明
- [ ] **故障排除指南**: 常见问题解决方案
- [ ] **备份脚本**: 数据备份和恢复脚本
- [ ] **监控脚本**: 系统监控和报警脚本

#### 培训材料
- [ ] **快速入门指南**
- [ ] **操作视频教程**
- [ ] **最佳实践文档**
- [ ] **安全操作规范**

---

## 📞 支持和维护

### 🔧 维护计划
- [ ] **日常检查**: 每日系统状态检查
- [ ] **周度维护**: 每周清理和优化
- [ ] **月度更新**: 每月安全更新
- [ ] **季度评估**: 每季度性能评估

### 📱 联系方式
- **技术支持**: support@verto.com
- **紧急联系**: +86-400-xxx-xxxx
- **文档中心**: https://docs.verto.com

---

**✅ 检查完成后，请确保所有项目都已勾选，然后可以开始正式部署！**