# 前端项目管理平台技术架构设计

**版本**：v1.0  
**日期**：2025-01-18  
**基于框架**：JeecgBoot 3.x + Vue3  

---

## 一、整体架构设计

### 1.1 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                        前端层 (Vue3)                        │
├─────────────────────────────────────────────────────────────┤
│  需求管理  │  应用管理  │  物料管理  │  人员管理  │  系统管理  │
├─────────────────────────────────────────────────────────────┤
│                     API网关 (Gateway)                      │
├─────────────────────────────────────────────────────────────┤
│                    业务服务层 (Spring Boot)                 │
├─────────────────────────────────────────────────────────────┤
│  需求服务  │  应用服务  │  物料服务  │  人员服务  │  集成服务  │
├─────────────────────────────────────────────────────────────┤
│                     数据访问层 (MyBatis Plus)               │
├─────────────────────────────────────────────────────────────┤
│    MySQL    │    Redis    │   MinIO   │  ElasticSearch    │
├─────────────────────────────────────────────────────────────┤
│              外部系统集成 (GitLab/Jenkins/禅道)              │
└─────────────────────────────────────────────────────────────┘
```

### 1.2 技术栈选型

#### 后端技术栈
- **框架**：Spring Boot 2.7.x
- **ORM**：MyBatis Plus 3.5.x
- **安全**：Spring Security + JWT
- **缓存**：Redis 6.x
- **数据库**：MySQL 8.0
- **文件存储**：MinIO
- **搜索引擎**：ElasticSearch 7.x
- **消息队列**：RabbitMQ
- **任务调度**：Quartz
- **API文档**：Swagger 3.x
- **监控**：Micrometer + Prometheus

#### 前端技术栈
- **框架**：Vue 3.3.x（基于JeecgBoot Vue3框架）
- **构建工具**：Vite 4.x
- **UI组件库**：Ant Design Vue 4.x + JeecgBoot组件库
- **状态管理**：Pinia
- **路由**：Vue Router 4.x
- **HTTP客户端**：Axios
- **图表库**：ECharts 5.x
- **代码编辑器**：Monaco Editor
- **富文本编辑器**：TinyMCE
- **表格组件**：JVxeTable（JeecgBoot增强表格）
- **表单组件**：JFormContainer（JeecgBoot表单容器）

#### 外部集成
- **版本控制**：GitLab API v4
- **CI/CD**：Jenkins REST API
- **项目管理**：禅道 (Web爬虫)
- **文档管理**：Confluence REST API
- **数据分析**：Matomo API
- **AI服务**：OpenAI API / 本地大模型

---

## 二、数据库设计

### 2.1 核心表结构

#### 需求管理相关表

```sql
-- 需求表
CREATE TABLE verto_requirement (
    id VARCHAR(32) PRIMARY KEY COMMENT '主键ID',
    zentao_id VARCHAR(50) COMMENT '禅道需求ID',
    title VARCHAR(200) NOT NULL COMMENT '需求标题',
    description TEXT COMMENT '需求描述',
    priority TINYINT DEFAULT 2 COMMENT '优先级：1-高，2-中，3-低',
    status VARCHAR(20) DEFAULT 'draft' COMMENT '状态：draft-草稿，active-激活，closed-关闭',
    type VARCHAR(20) DEFAULT 'feature' COMMENT '类型：feature-功能，bug-缺陷，improvement-改进',
    assignee VARCHAR(32) COMMENT '指派人',
    reporter VARCHAR(32) COMMENT '报告人',
    project_id VARCHAR(32) COMMENT '所属项目',
    prototype_url VARCHAR(500) COMMENT '原型链接',
    page_schema TEXT COMMENT '页面Schema JSON',
    branch_name VARCHAR(100) COMMENT '关联分支名',
    srs_doc_url VARCHAR(500) COMMENT 'SRS文档链接',
    estimated_hours DECIMAL(8,2) COMMENT '预估工时',
    actual_hours DECIMAL(8,2) COMMENT '实际工时',
    start_date DATE COMMENT '开始日期',
    end_date DATE COMMENT '结束日期',
    create_by VARCHAR(32) COMMENT '创建人',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    update_by VARCHAR(32) COMMENT '更新人',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    del_flag TINYINT DEFAULT 0 COMMENT '删除标志：0-正常，1-删除',
    tenant_id VARCHAR(32) COMMENT '租户ID'
) COMMENT='需求表';

-- 需求状态变更历史表
CREATE TABLE verto_requirement_history (
    id VARCHAR(32) PRIMARY KEY COMMENT '主键ID',
    requirement_id VARCHAR(32) NOT NULL COMMENT '需求ID',
    old_status VARCHAR(20) COMMENT '原状态',
    new_status VARCHAR(20) COMMENT '新状态',
    change_reason TEXT COMMENT '变更原因',
    change_by VARCHAR(32) COMMENT '变更人',
    change_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '变更时间'
) COMMENT='需求状态变更历史表';
```

#### 应用管理相关表

```sql
-- 应用表
CREATE TABLE verto_application (
    id VARCHAR(32) PRIMARY KEY COMMENT '主键ID',
    app_name VARCHAR(100) NOT NULL COMMENT '应用名称',
    app_code VARCHAR(50) NOT NULL UNIQUE COMMENT '应用编码',
    description TEXT COMMENT '应用描述',
    gitlab_project_id VARCHAR(50) COMMENT 'GitLab项目ID',
    gitlab_url VARCHAR(500) COMMENT 'GitLab仓库地址',
    jenkins_job_name VARCHAR(100) COMMENT 'Jenkins任务名',
    deploy_env VARCHAR(20) DEFAULT 'dev' COMMENT '部署环境：dev-开发，test-测试，prod-生产',
    app_type VARCHAR(20) DEFAULT 'web' COMMENT '应用类型：web-前端，api-后端，mobile-移动端',
    tech_stack VARCHAR(100) COMMENT '技术栈',
    owner VARCHAR(32) COMMENT '负责人',
    team_id VARCHAR(32) COMMENT '所属团队',
    status VARCHAR(20) DEFAULT 'active' COMMENT '状态：active-活跃，inactive-非活跃，archived-归档',
    matomo_site_id VARCHAR(20) COMMENT 'Matomo站点ID',
    create_by VARCHAR(32) COMMENT '创建人',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    update_by VARCHAR(32) COMMENT '更新人',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    del_flag TINYINT DEFAULT 0 COMMENT '删除标志：0-正常，1-删除',
    tenant_id VARCHAR(32) COMMENT '租户ID'
) COMMENT='应用表';

-- 应用构建记录表
CREATE TABLE verto_build_record (
    id VARCHAR(32) PRIMARY KEY COMMENT '主键ID',
    application_id VARCHAR(32) NOT NULL COMMENT '应用ID',
    build_number INT COMMENT '构建号',
    branch_name VARCHAR(100) COMMENT '分支名',
    commit_id VARCHAR(50) COMMENT '提交ID',
    build_status VARCHAR(20) COMMENT '构建状态：building-构建中，success-成功，failed-失败',
    build_duration INT COMMENT '构建耗时(秒)',
    build_log TEXT COMMENT '构建日志',
    trigger_by VARCHAR(32) COMMENT '触发人',
    build_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '构建时间'
) COMMENT='应用构建记录表';
```

#### 物料管理相关表

```sql
-- 物料表
CREATE TABLE verto_material (
    id VARCHAR(32) PRIMARY KEY COMMENT '主键ID',
    material_name VARCHAR(100) NOT NULL COMMENT '物料名称',
    material_code VARCHAR(50) NOT NULL UNIQUE COMMENT '物料编码',
    material_type VARCHAR(20) NOT NULL COMMENT '物料类型：component-组件，template-模板，page-页面',
    category VARCHAR(50) COMMENT '分类',
    description TEXT COMMENT '描述',
    version VARCHAR(20) DEFAULT '1.0.0' COMMENT '版本号',
    author VARCHAR(32) COMMENT '作者',
    tags VARCHAR(200) COMMENT '标签，逗号分隔',
    preview_url VARCHAR(500) COMMENT '预览地址',
    demo_url VARCHAR(500) COMMENT '演示地址',
    source_code TEXT COMMENT '源代码',
    dependencies TEXT COMMENT '依赖信息JSON',
    props_schema TEXT COMMENT '属性Schema JSON',
    usage_doc TEXT COMMENT '使用文档',
    download_count INT DEFAULT 0 COMMENT '下载次数',
    star_count INT DEFAULT 0 COMMENT '点赞次数',
    status VARCHAR(20) DEFAULT 'published' COMMENT '状态：draft-草稿，published-已发布，deprecated-已废弃',
    create_by VARCHAR(32) COMMENT '创建人',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    update_by VARCHAR(32) COMMENT '更新人',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    del_flag TINYINT DEFAULT 0 COMMENT '删除标志：0-正常，1-删除',
    tenant_id VARCHAR(32) COMMENT '租户ID'
) COMMENT='物料表';

-- 物料版本表
CREATE TABLE verto_material_version (
    id VARCHAR(32) PRIMARY KEY COMMENT '主键ID',
    material_id VARCHAR(32) NOT NULL COMMENT '物料ID',
    version VARCHAR(20) NOT NULL COMMENT '版本号',
    changelog TEXT COMMENT '变更日志',
    source_code TEXT COMMENT '源代码',
    bundle_url VARCHAR(500) COMMENT '打包文件地址',
    is_latest TINYINT DEFAULT 0 COMMENT '是否最新版本：0-否，1-是',
    create_by VARCHAR(32) COMMENT '创建人',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间'
) COMMENT='物料版本表';
```

#### 人员管理相关表

```sql
-- 人员表
CREATE TABLE verto_personnel (
    id VARCHAR(32) PRIMARY KEY COMMENT '主键ID',
    user_id VARCHAR(32) NOT NULL COMMENT '用户ID，关联sys_user表',
    employee_no VARCHAR(50) COMMENT '工号',
    position VARCHAR(50) COMMENT '职位',
    level VARCHAR(20) COMMENT '级别',
    department VARCHAR(50) COMMENT '部门',
    team VARCHAR(50) COMMENT '团队',
    skills TEXT COMMENT '技能标签JSON',
    experience_years DECIMAL(3,1) COMMENT '工作年限',
    join_date DATE COMMENT '入职日期',
    mentor VARCHAR(32) COMMENT '导师',
    status VARCHAR(20) DEFAULT 'active' COMMENT '状态：active-在职，inactive-离职，leave-请假',
    create_by VARCHAR(32) COMMENT '创建人',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    update_by VARCHAR(32) COMMENT '更新人',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    del_flag TINYINT DEFAULT 0 COMMENT '删除标志：0-正常，1-删除',
    tenant_id VARCHAR(32) COMMENT '租户ID'
) COMMENT='人员表';

-- 工时记录表
CREATE TABLE verto_timesheet (
    id VARCHAR(32) PRIMARY KEY COMMENT '主键ID',
    personnel_id VARCHAR(32) NOT NULL COMMENT '人员ID',
    work_date DATE NOT NULL COMMENT '工作日期',
    project_id VARCHAR(32) COMMENT '项目ID',
    requirement_id VARCHAR(32) COMMENT '需求ID',
    work_hours DECIMAL(4,2) NOT NULL COMMENT '工作小时数',
    work_type VARCHAR(20) DEFAULT 'development' COMMENT '工作类型：development-开发，testing-测试，meeting-会议，other-其他',
    description TEXT COMMENT '工作描述',
    status VARCHAR(20) DEFAULT 'submitted' COMMENT '状态：draft-草稿，submitted-已提交，approved-已审批',
    approve_by VARCHAR(32) COMMENT '审批人',
    approve_time DATETIME COMMENT '审批时间',
    create_by VARCHAR(32) COMMENT '创建人',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    update_by VARCHAR(32) COMMENT '更新人',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间'
) COMMENT='工时记录表';
```

#### 集成配置相关表

```sql
-- 集成配置表
CREATE TABLE verto_integration_config (
    id VARCHAR(32) PRIMARY KEY COMMENT '主键ID',
    config_type VARCHAR(50) NOT NULL COMMENT '配置类型：gitlab，jenkins，zentao，confluence，matomo',
    config_name VARCHAR(100) NOT NULL COMMENT '配置名称',
    base_url VARCHAR(500) NOT NULL COMMENT '基础URL',
    access_token VARCHAR(500) COMMENT '访问令牌',
    username VARCHAR(100) COMMENT '用户名',
    password VARCHAR(200) COMMENT '密码（加密存储）',
    extra_config TEXT COMMENT '额外配置JSON',
    is_enabled TINYINT DEFAULT 1 COMMENT '是否启用：0-禁用，1-启用',
    test_status VARCHAR(20) COMMENT '测试状态：success-成功，failed-失败',
    test_time DATETIME COMMENT '测试时间',
    create_by VARCHAR(32) COMMENT '创建人',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    update_by VARCHAR(32) COMMENT '更新人',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    del_flag TINYINT DEFAULT 0 COMMENT '删除标志：0-正常，1-删除',
    tenant_id VARCHAR(32) COMMENT '租户ID'
) COMMENT='集成配置表';
```

### 2.2 索引设计

```sql
-- 需求表索引
CREATE INDEX idx_requirement_zentao_id ON verto_requirement(zentao_id);
CREATE INDEX idx_requirement_status ON verto_requirement(status);
CREATE INDEX idx_requirement_assignee ON verto_requirement(assignee);
CREATE INDEX idx_requirement_project_id ON verto_requirement(project_id);
CREATE INDEX idx_requirement_create_time ON verto_requirement(create_time);

-- 应用表索引
CREATE INDEX idx_application_code ON verto_application(app_code);
CREATE INDEX idx_application_owner ON verto_application(owner);
CREATE INDEX idx_application_status ON verto_application(status);

-- 物料表索引
CREATE INDEX idx_material_code ON verto_material(material_code);
CREATE INDEX idx_material_type ON verto_material(material_type);
CREATE INDEX idx_material_category ON verto_material(category);
CREATE INDEX idx_material_status ON verto_material(status);

-- 工时记录表索引
CREATE INDEX idx_timesheet_personnel_date ON verto_timesheet(personnel_id, work_date);
CREATE INDEX idx_timesheet_project_id ON verto_timesheet(project_id);
CREATE INDEX idx_timesheet_requirement_id ON verto_timesheet(requirement_id);
```

---

## 三、后端架构设计

### 3.1 模块结构

```
jeecg-boot-module-verto/
├── src/main/java/org/jeecg/modules/verto/
│   ├── common/                    # 公共组件
│   │   ├── constant/              # 常量定义
│   │   ├── enums/                 # 枚举类
│   │   ├── exception/             # 异常类
│   │   └── util/                  # 工具类
│   ├── config/                    # 配置类
│   │   ├── IntegrationConfig.java # 集成配置
│   │   ├── ScheduleConfig.java    # 定时任务配置
│   │   └── SecurityConfig.java    # 安全配置
│   ├── requirement/               # 需求管理模块
│   │   ├── controller/
│   │   ├── service/
│   │   ├── entity/
│   │   ├── mapper/
│   │   └── dto/
│   ├── application/               # 应用管理模块
│   │   ├── controller/
│   │   ├── service/
│   │   ├── entity/
│   │   ├── mapper/
│   │   └── dto/
│   ├── material/                  # 物料管理模块
│   │   ├── controller/
│   │   ├── service/
│   │   ├── entity/
│   │   ├── mapper/
│   │   └── dto/
│   ├── personnel/                 # 人员管理模块
│   │   ├── controller/
│   │   ├── service/
│   │   ├── entity/
│   │   ├── mapper/
│   │   └── dto/
│   └── integration/               # 外部集成模块
│       ├── gitlab/
│       ├── jenkins/
│       ├── zentao/
│       ├── confluence/
│       └── matomo/
└── src/main/resources/
    ├── mapper/                    # MyBatis映射文件
    ├── templates/                 # 模板文件
    └── application-verto.yml      # 模块配置
```

### 3.2 核心服务设计

#### 需求管理服务

```java
@Service
@Transactional
public class RequirementService extends ServiceImpl<RequirementMapper, Requirement> {
    
    @Autowired
    private ZentaoSyncService zentaoSyncService;
    
    @Autowired
    private GitlabService gitlabService;
    
    @Autowired
    private SrsGenerateService srsGenerateService;
    
    /**
     * 同步禅道需求
     */
    public void syncFromZentao(String projectId) {
        List<RequirementDTO> requirements = zentaoSyncService.syncRequirements(projectId);
        // 批量保存或更新需求
        this.saveOrUpdateBatch(requirements.stream()
            .map(this::convertToEntity)
            .collect(Collectors.toList()));
    }
    
    /**
     * 创建Git分支
     */
    public String createGitBranch(String requirementId, String branchName) {
        Requirement requirement = this.getById(requirementId);
        String branchUrl = gitlabService.createBranch(
            requirement.getProjectId(), branchName, "develop");
        
        // 更新需求分支信息
        requirement.setBranchName(branchName);
        this.updateById(requirement);
        
        return branchUrl;
    }
    
    /**
     * 生成SRS文档
     */
    public String generateSrsDocument(String requirementId) {
        Requirement requirement = this.getById(requirementId);
        byte[] document = srsGenerateService.generateSrsDocument(requirement);
        
        // 上传到文件服务器
        String documentUrl = fileService.upload(document, "srs_" + requirementId + ".docx");
        
        // 更新需求文档链接
        requirement.setSrsDocUrl(documentUrl);
        this.updateById(requirement);
        
        return documentUrl;
    }
}
```

#### GitLab集成服务

```java
@Service
public class GitlabService {
    
    @Autowired
    private RestTemplate restTemplate;
    
    @Value("${verto.gitlab.base-url}")
    private String gitlabBaseUrl;
    
    @Value("${verto.gitlab.access-token}")
    private String accessToken;
    
    /**
     * 创建分支
     */
    public String createBranch(String projectId, String branchName, String fromBranch) {
        String url = gitlabBaseUrl + "/api/v4/projects/" + projectId + "/repository/branches";
        
        HttpHeaders headers = new HttpHeaders();
        headers.set("PRIVATE-TOKEN", accessToken);
        headers.setContentType(MediaType.APPLICATION_JSON);
        
        Map<String, String> requestBody = new HashMap<>();
        requestBody.put("branch", branchName);
        requestBody.put("ref", fromBranch);
        
        HttpEntity<Map<String, String>> request = new HttpEntity<>(requestBody, headers);
        
        try {
            ResponseEntity<Map> response = restTemplate.postForEntity(url, request, Map.class);
            if (response.getStatusCode().is2xxSuccessful()) {
                Map<String, Object> responseBody = response.getBody();
                return (String) responseBody.get("web_url");
            }
        } catch (Exception e) {
            log.error("创建GitLab分支失败", e);
            throw new BusinessException("创建GitLab分支失败: " + e.getMessage());
        }
        
        return null;
    }
    
    /**
     * 获取分支列表
     */
    public List<BranchDTO> getBranches(String projectId) {
        String url = gitlabBaseUrl + "/api/v4/projects/" + projectId + "/repository/branches";
        
        HttpHeaders headers = new HttpHeaders();
        headers.set("PRIVATE-TOKEN", accessToken);
        
        HttpEntity<String> request = new HttpEntity<>(headers);
        
        try {
            ResponseEntity<List> response = restTemplate.exchange(url, HttpMethod.GET, request, List.class);
            if (response.getStatusCode().is2xxSuccessful()) {
                List<Map<String, Object>> branches = response.getBody();
                return branches.stream()
                    .map(this::convertToBranchDTO)
                    .collect(Collectors.toList());
            }
        } catch (Exception e) {
            log.error("获取GitLab分支列表失败", e);
            throw new BusinessException("获取GitLab分支列表失败: " + e.getMessage());
        }
        
        return Collections.emptyList();
    }
}
```

#### 禅道同步服务

```java
@Service
public class ZentaoSyncService {
    
    @Autowired
    private PlaywrightService playwrightService;
    
    /**
     * 同步禅道需求
     */
    public List<RequirementDTO> syncRequirements(String projectId) {
        try {
            // 使用Playwright登录禅道
            Page page = playwrightService.login();
            
            // 导航到项目需求页面
            page.navigate("/zentao/project-story-" + projectId + ".html");
            
            // 解析需求列表
            List<ElementHandle> requirementRows = page.querySelectorAll("#storyList tbody tr");
            
            List<RequirementDTO> requirements = new ArrayList<>();;
            for (ElementHandle row : requirementRows) {
                RequirementDTO requirement = parseRequirementRow(row);
                if (requirement != null) {
                    requirements.add(requirement);
                }
            }
            
            return requirements;
        } catch (Exception e) {
            log.error("同步禅道需求失败", e);
            throw new BusinessException("同步禅道需求失败: " + e.getMessage());
        }
    }
    
    /**
     * 解析需求行数据
     */
    private RequirementDTO parseRequirementRow(ElementHandle row) {
        try {
            String id = row.querySelector(".id").textContent();
            String title = row.querySelector(".title a").textContent();
            String status = row.querySelector(".status").textContent();
            String assignee = row.querySelector(".assignedTo").textContent();
            
            RequirementDTO requirement = new RequirementDTO();
            requirement.setZentaoId(id);
            requirement.setTitle(title);
            requirement.setStatus(mapZentaoStatus(status));
            requirement.setAssignee(assignee);
            
            return requirement;
        } catch (Exception e) {
            log.warn("解析需求行数据失败", e);
            return null;
        }
    }
}
```

### 3.3 定时任务设计

```java
@Component
public class ScheduledTasks {
    
    @Autowired
    private RequirementService requirementService;
    
    @Autowired
    private ApplicationService applicationService;
    
    /**
     * 每小时同步一次禅道需求
     */
    @Scheduled(cron = "0 0 * * * ?")
    public void syncZentaoRequirements() {
        log.info("开始同步禅道需求");
        try {
            List<String> projectIds = getActiveProjectIds();
            for (String projectId : projectIds) {
                requirementService.syncFromZentao(projectId);
            }
            log.info("禅道需求同步完成");
        } catch (Exception e) {
            log.error("禅道需求同步失败", e);
        }
    }
    
    /**
     * 每5分钟检查一次构建状态
     */
    @Scheduled(cron = "0 */5 * * * ?")
    public void checkBuildStatus() {
        log.info("开始检查构建状态");
        try {
            applicationService.checkAllBuildStatus();
            log.info("构建状态检查完成");
        } catch (Exception e) {
            log.error("构建状态检查失败", e);
        }
    }
}
```

---

## 四、前端架构设计

### 4.1 项目结构

```
src/
├── api/                          # API接口
│   ├── verto/
│   │   ├── requirement.ts
│   │   ├── application.ts
│   │   ├── material.ts
│   │   └── personnel.ts
│   └── index.ts
├── components/                   # 公共组件（基于JeecgBoot组件）
│   ├── Verto/
│   │   ├── RequirementCard.vue   # 需求卡片（基于j-card）
│   │   ├── ApplicationCard.vue   # 应用卡片（基于j-card）
│   │   ├── MaterialPreview.vue   # 物料预览（基于j-modal）
│   │   ├── PersonnelCard.vue     # 人员卡片（基于j-card）
│   │   ├── RequirementTable.vue  # 需求表格（基于j-vxe-table）
│   │   └── MaterialForm.vue      # 物料表单（基于j-form-container）
│   └── index.ts
├── views/verto/                  # 页面组件
│   ├── requirement/
│   │   ├── RequirementList.vue
│   │   ├── RequirementDetail.vue
│   │   ├── RequirementForm.vue
│   │   └── components/
│   ├── application/
│   │   ├── ApplicationList.vue
│   │   ├── ApplicationDetail.vue
│   │   ├── ApplicationForm.vue
│   │   └── components/
│   ├── material/
│   │   ├── MaterialRegistry.vue
│   │   ├── MaterialDetail.vue
│   │   ├── MaterialForm.vue
│   │   └── components/
│   └── personnel/
│       ├── PersonnelList.vue
│       ├── PersonnelDetail.vue
│       ├── PersonnelForm.vue
│       └── components/
├── stores/                       # 状态管理
│   ├── modules/
│   │   ├── requirement.ts
│   │   ├── application.ts
│   │   ├── material.ts
│   │   └── personnel.ts
│   └── index.ts
├── router/                       # 路由配置
│   └── modules/
│       └── verto.ts
├── utils/                        # 工具函数
│   ├── verto/
│   │   ├── requirement.ts
│   │   ├── application.ts
│   │   └── material.ts
│   └── index.ts
└── types/                        # 类型定义
    └── verto/
        ├── requirement.ts
        ├── application.ts
        ├── material.ts
        └── personnel.ts
```

### 4.2 状态管理设计

```typescript
// stores/modules/requirement.ts
import { defineStore } from 'pinia'
import { RequirementAPI } from '@/api/verto/requirement'
import type { Requirement, RequirementQuery } from '@/types/verto/requirement'

export const useRequirementStore = defineStore('requirement', {
  state: () => ({
    requirements: [] as Requirement[],
    currentRequirement: null as Requirement | null,
    loading: false,
    total: 0,
    query: {
      current: 1,
      size: 10,
      status: '',
      assignee: '',
      projectId: ''
    } as RequirementQuery
  }),

  getters: {
    // 按状态分组的需求
    requirementsByStatus: (state) => {
      const groups: Record<string, Requirement[]> = {}
      state.requirements.forEach(req => {
        if (!groups[req.status]) {
          groups[req.status] = []
        }
        groups[req.status].push(req)
      })
      return groups
    },

    // 我的需求
    myRequirements: (state) => {
      const currentUser = useUserStore().userInfo
      return state.requirements.filter(req => req.assignee === currentUser.id)
    }
  },

  actions: {
    // 获取需求列表
    async fetchRequirements(query?: Partial<RequirementQuery>) {
      this.loading = true
      try {
        if (query) {
          this.query = { ...this.query, ...query }
        }
        const response = await RequirementAPI.getList(this.query)
        this.requirements = response.records
        this.total = response.total
      } catch (error) {
        console.error('获取需求列表失败:', error)
      } finally {
        this.loading = false
      }
    },

    // 获取需求详情
    async fetchRequirementDetail(id: string) {
      try {
        const requirement = await RequirementAPI.getDetail(id)
        this.currentRequirement = requirement
        return requirement
      } catch (error) {
        console.error('获取需求详情失败:', error)
        throw error
      }
    },

    // 创建Git分支
    async createGitBranch(id: string, branchName: string) {
      try {
        const branchUrl = await RequirementAPI.createGitBranch(id, branchName)
        // 更新当前需求的分支信息
        if (this.currentRequirement && this.currentRequirement.id === id) {
          this.currentRequirement.branchName = branchName
        }
        return branchUrl
      } catch (error) {
        console.error('创建Git分支失败:', error)
        throw error
      }
    },

    // 同步禅道需求
    async syncFromZentao(projectId: string) {
      try {
        await RequirementAPI.syncFromZentao(projectId)
        // 重新获取需求列表
        await this.fetchRequirements()
      } catch (error) {
        console.error('同步禅道需求失败:', error)
        throw error
      }
    }
  }
})
```

### 4.3 组件设计（基于JeecgBoot组件库）

#### 需求表格组件

```vue
<!-- components/Verto/RequirementTable.vue -->
<template>
  <div class="requirement-table">
    <BasicTable
      @register="registerTable"
      :searchInfo="searchInfo"
      :rowSelection="{ type: 'checkbox', selectedRowKeys: checkedKeys, onChange: onSelectChange }"
    >
      <template #tableTitle>
        <a-button
          type="primary"
          @click="handleAdd"
          preIcon="ant-design:plus-outlined"
        >
          新增需求
        </a-button>
        <a-button
          type="primary"
          @click="handleSync"
          preIcon="ant-design:sync-outlined"
          :loading="syncLoading"
        >
          同步禅道
        </a-button>
      </template>
      
      <template #action="{ record }">
        <TableAction
          :actions="[
            {
              icon: 'clarity:note-edit-line',
              tooltip: '编辑需求',
              onClick: handleEdit.bind(null, record),
            },
            {
              icon: 'ant-design:eye-outlined',
              tooltip: '查看详情',
              onClick: handleDetail.bind(null, record),
            },
            {
              icon: 'ant-design:branch-outlined',
              tooltip: '创建分支',
              ifShow: !record.branchName,
              onClick: handleCreateBranch.bind(null, record),
            },
            {
              icon: 'ant-design:file-text-outlined',
              tooltip: '生成SRS',
              onClick: handleGenerateSRS.bind(null, record),
            },
          ]"
          :dropDownActions="[
            {
              label: '删除',
              icon: 'ant-design:delete-outlined',
              color: 'error',
              popConfirm: {
                title: '是否确认删除',
                confirm: handleDelete.bind(null, record),
              },
            },
          ]"
        />
      </template>
    </BasicTable>
    
    <RequirementModal @register="registerModal" @success="handleSuccess" />
  </div>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue'
import { BasicTable, useTable, TableAction } from '/@/components/Table'
import { useModal } from '/@/components/Modal'
import { useMessage } from '/@/hooks/web/useMessage'
import RequirementModal from './RequirementModal.vue'
import { columns, searchFormSchema } from './requirement.data'
import { getRequirementList, deleteRequirement, syncFromZentao } from '/@/api/verto/requirement'

const { createMessage } = useMessage()
const checkedKeys = ref<Array<string | number>>([])
const syncLoading = ref(false)

const [registerTable, { reload, getForm }] = useTable({
  title: '需求列表',
  api: getRequirementList,
  rowKey: 'id',
  columns,
  formConfig: {
    labelWidth: 120,
    schemas: searchFormSchema,
    autoSubmitOnEnter: true,
  },
  useSearchForm: true,
  showTableSetting: true,
  bordered: true,
  handleSearchInfoFn(info) {
    return info
  },
  actionColumn: {
    width: 120,
    title: '操作',
    dataIndex: 'action',
    slots: { customRender: 'action' },
  },
})

const [registerModal, { openModal }] = useModal()

const searchInfo = reactive<Recordable>({})

function onSelectChange(selectedRowKeys: (string | number)[]) {
  checkedKeys.value = selectedRowKeys
}

function handleAdd() {
  openModal(true, {
    isUpdate: false,
  })
}

function handleEdit(record: Recordable) {
  openModal(true, {
    record,
    isUpdate: true,
  })
}

function handleDetail(record: Recordable) {
  // 跳转到详情页
  // router.push(`/verto/requirement/detail/${record.id}`)
}

function handleDelete(record: Recordable) {
  deleteRequirement(record.id).then(() => {
    createMessage.success('删除成功')
    reload()
  })
}

function handleCreateBranch(record: Recordable) {
  // 创建Git分支逻辑
  createMessage.success('分支创建成功')
  reload()
}

function handleGenerateSRS(record: Recordable) {
  // 生成SRS文档逻辑
  createMessage.success('SRS文档生成成功')
}

function handleSync() {
  syncLoading.value = true
  syncFromZentao()
    .then(() => {
      createMessage.success('同步成功')
      reload()
    })
    .finally(() => {
      syncLoading.value = false
    })
}

function handleSuccess() {
  reload()
}
</script>
```

#### 需求表单组件

```vue
<!-- components/Verto/RequirementModal.vue -->
<template>
  <BasicModal
    v-bind="$attrs"
    @register="registerModal"
    :title="getTitle"
    @ok="handleSubmit"
  >
    <BasicForm @register="registerForm" />
  </BasicModal>
</template>

<script setup lang="ts">
import { ref, computed, unref } from 'vue'
import { BasicModal, useModalInner } from '/@/components/Modal'
import { BasicForm, useForm } from '/@/components/Form'
import { formSchema } from './requirement.data'
import { createRequirement, updateRequirement } from '/@/api/verto/requirement'

const emit = defineEmits(['success', 'register'])

const isUpdate = ref(true)
const rowId = ref('')

const [registerForm, { setFieldsValue, updateSchema, resetFields, validate }] = useForm({
  labelWidth: 100,
  baseColProps: { span: 24 },
  schemas: formSchema,
  showActionButtonGroup: false,
  autoSubmitOnEnter: true,
})

const [registerModal, { setModalProps, closeModal }] = useModalInner(async (data) => {
  resetFields()
  setModalProps({ confirmLoading: false })
  isUpdate.value = !!data?.isUpdate

  if (unref(isUpdate)) {
    rowId.value = data.record.id
    setFieldsValue({
      ...data.record,
    })
  }

  // 动态更新表单schema
  updateSchema([
    {
      field: 'zentaoId',
      componentProps: {
        disabled: unref(isUpdate),
      },
    },
  ])
})

const getTitle = computed(() => (!unref(isUpdate) ? '新增需求' : '编辑需求'))

async function handleSubmit() {
  try {
    const values = await validate()
    setModalProps({ confirmLoading: true })
    
    if (unref(isUpdate)) {
      await updateRequirement({ ...values, id: rowId.value })
    } else {
      await createRequirement(values)
    }
    
    closeModal()
    emit('success')
  } finally {
    setModalProps({ confirmLoading: false })
  }
}
</script>
```

#### 需求管理组件（基于JeecgBoot组件库）

```vue
<!-- components/Verto/RequirementCard.vue -->
<template>
  <j-card 
    :title="requirement.title"
    :bordered="false"
    class="requirement-card"
    :class="`status-${requirement.status}`"
  >
    <template #extra>
      <j-tag :color="getStatusColor(requirement.status)">
        {{ getStatusText(requirement.status) }}
      </j-tag>
    </template>

    <div class="requirement-content">
      <div class="requirement-meta">
        <span class="meta-item">
          <UserOutlined />
          {{ requirement.assigneeName || '未指派' }}
        </span>
        <span class="meta-item">
          <CalendarOutlined />
          {{ formatDate(requirement.createTime) }}
        </span>
        <span class="meta-item">
          <FlagOutlined />
          {{ getPriorityText(requirement.priority) }}
        </span>
      </div>

      <div class="requirement-description">
        {{ requirement.description || '暂无描述' }}
      </div>

      <div class="requirement-actions">
        <j-button 
          type="link" 
          size="small"
          @click="viewDetail"
        >
          查看详情
        </j-button>
        
        <j-button 
          v-if="!requirement.branchName"
          type="link" 
          size="small"
          @click="createBranch"
        >
          创建分支
        </j-button>
        
        <j-button 
          v-if="requirement.branchName"
          type="link" 
          size="small"
          @click="openIDE"
        >
          打开IDE
        </j-button>
        
        <j-button 
          type="link" 
          size="small"
          @click="generateSRS"
        >
          生成SRS
        </j-button>
      </div>
    </div>
  </j-card>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import { useRouter } from 'vue-router'
import { useMessage } from '/@/hooks/web/useMessage'
import { UserOutlined, CalendarOutlined, FlagOutlined } from '@ant-design/icons-vue'
import { useRequirementStore } from '@/stores/modules/requirement'
import type { Requirement } from '@/types/verto/requirement'
import { formatDate } from '@/utils/date'

interface Props {
  requirement: Requirement
}

const props = defineProps<Props>()
const router = useRouter()
const requirementStore = useRequirementStore()
const { createMessage } = useMessage()

// 状态颜色映射
const statusColorMap = {
  draft: 'default',
  active: 'processing',
  testing: 'warning',
  closed: 'success'
}

// 状态文本映射
const statusTextMap = {
  draft: '草稿',
  active: '进行中',
  testing: '测试中',
  closed: '已关闭'
}

// 优先级文本映射
const priorityTextMap = {
  1: '高',
  2: '中',
  3: '低'
}

const getStatusColor = (status: string) => statusColorMap[status] || 'default'
const getStatusText = (status: string) => statusTextMap[status] || status
const getPriorityText = (priority: number) => priorityTextMap[priority] || '中'

// 查看详情
const viewDetail = () => {
  router.push(`/verto/requirement/detail/${props.requirement.id}`)
}

// 创建分支
const createBranch = async () => {
  try {
    createMessage.loading('正在创建Git分支...', 1)
    const branchName = `feature/req-${props.requirement.zentaoId}`
    await requirementStore.createGitBranch(props.requirement.id, branchName)
    createMessage.success('Git分支创建成功')
  } catch (error) {
    createMessage.error('Git分支创建失败')
  }
}

// 打开IDE
const openIDE = () => {
  const ideUrl = `vscode://vscode.git/clone?url=${props.requirement.gitlabUrl}&branch=${props.requirement.branchName}`
  window.open(ideUrl)
}

// 生成SRS文档
const generateSRS = async () => {
  try {
    createMessage.loading('正在生成SRS文档...', 1)
    await requirementStore.generateSRS(props.requirement.id)
    createMessage.success('SRS文档生成成功')
  } catch (error) {
    createMessage.error('SRS文档生成失败')
  }
}
</script>

<style scoped>
.requirement-card {
  margin-bottom: 16px;
  transition: all 0.3s;
}

.requirement-card:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.requirement-content {
  padding: 8px 0;
}

.requirement-meta {
  display: flex;
  gap: 16px;
  margin-bottom: 12px;
  color: #666;
  font-size: 12px;
}

.meta-item {
  display: flex;
  align-items: center;
  gap: 4px;
}

.requirement-description {
  margin-bottom: 12px;
  color: #333;
  line-height: 1.5;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.requirement-actions {
  display: flex;
  gap: 8px;
}

.status-draft {
  border-left: 4px solid #d9d9d9;
}

.status-active {
  border-left: 4px solid #1890ff;
}

.status-testing {
  border-left: 4px solid #faad14;
}

.status-closed {
  border-left: 4px solid #52c41a;
}
</style>
```

#### 应用管理组件

```vue
<!-- components/Verto/ApplicationCard.vue -->
<template>
  <j-card 
    :title="application.appName"
    :bordered="false"
    class="application-card"
    :class="`status-${application.status}`"
  >
    <template #extra>
      <j-tag :color="getStatusColor(application.status)">
        {{ getStatusText(application.status) }}
      </j-tag>
    </template>

    <div class="application-content">
      <div class="application-meta">
        <span class="meta-item">
          <CodeOutlined />
          {{ application.appCode }}
        </span>
        <span class="meta-item">
          <UserOutlined />
          {{ application.ownerName || '未指派' }}
        </span>
        <span class="meta-item">
          <TagOutlined />
          {{ application.techStack }}
        </span>
      </div>

      <div class="application-description">
        {{ application.description || '暂无描述' }}
      </div>

      <div class="application-stats">
        <div class="stat-item">
          <span class="stat-label">最新构建:</span>
          <span class="stat-value" :class="getBuildStatusClass(application.lastBuildStatus)">
            {{ getBuildStatusText(application.lastBuildStatus) }}
          </span>
        </div>
        <div class="stat-item">
          <span class="stat-label">部署环境:</span>
          <span class="stat-value">{{ getEnvText(application.deployEnv) }}</span>
        </div>
      </div>

      <div class="application-actions">
        <j-button 
          type="link" 
          size="small"
          @click="viewDetail"
        >
          查看详情
        </j-button>
        
        <j-button 
          type="link" 
          size="small"
          @click="openGitlab"
        >
          GitLab
        </j-button>
        
        <j-button 
          type="link" 
          size="small"
          @click="triggerBuild"
          :loading="buildLoading"
        >
          构建部署
        </j-button>
        
        <j-button 
          type="link" 
          size="small"
          @click="viewAnalytics"
        >
          数据分析
        </j-button>
      </div>
    </div>
  </j-card>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { useRouter } from 'vue-router'
import { useMessage } from '/@/hooks/web/useMessage'
import { CodeOutlined, UserOutlined, TagOutlined } from '@ant-design/icons-vue'
import { useApplicationStore } from '@/stores/modules/application'
import type { Application } from '@/types/verto/application'

interface Props {
  application: Application
}

const props = defineProps<Props>()
const router = useRouter()
const applicationStore = useApplicationStore()
const { createMessage } = useMessage()
const buildLoading = ref(false)

// 状态颜色映射
const statusColorMap = {
  active: 'success',
  inactive: 'default',
  archived: 'warning'
}

// 状态文本映射
const statusTextMap = {
  active: '活跃',
  inactive: '非活跃',
  archived: '已归档'
}

// 构建状态映射
const buildStatusTextMap = {
  success: '成功',
  failed: '失败',
  building: '构建中',
  pending: '等待中'
}

// 环境文本映射
const envTextMap = {
  dev: '开发环境',
  test: '测试环境',
  prod: '生产环境'
}

const getStatusColor = (status: string) => statusColorMap[status] || 'default'
const getStatusText = (status: string) => statusTextMap[status] || status
const getBuildStatusText = (status: string) => buildStatusTextMap[status] || status
const getEnvText = (env: string) => envTextMap[env] || env

const getBuildStatusClass = (status: string) => {
  const classMap = {
    success: 'text-success',
    failed: 'text-error',
    building: 'text-warning',
    pending: 'text-info'
  }
  return classMap[status] || ''
}

// 查看详情
const viewDetail = () => {
  router.push(`/verto/application/detail/${props.application.id}`)
}

// 打开GitLab
const openGitlab = () => {
  if (props.application.gitlabUrl) {
    window.open(props.application.gitlabUrl, '_blank')
  } else {
    createMessage.warning('未配置GitLab地址')
  }
}

// 触发构建
const triggerBuild = async () => {
  buildLoading.value = true
  try {
    createMessage.loading('正在触发构建...', 1)
    await applicationStore.triggerBuild(props.application.id)
    createMessage.success('构建任务已触发')
  } catch (error) {
    createMessage.error('构建触发失败')
  } finally {
    buildLoading.value = false
  }
}

// 查看数据分析
const viewAnalytics = () => {
  if (props.application.matomoSiteId) {
    router.push(`/verto/application/analytics/${props.application.id}`)
  } else {
    createMessage.warning('未配置数据分析')
  }
}
</script>

<style scoped>
.application-card {
  margin-bottom: 16px;
  transition: all 0.3s;
}

.application-card:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.application-content {
  padding: 8px 0;
}

.application-meta {
  display: flex;
  gap: 16px;
  margin-bottom: 12px;
  color: #666;
  font-size: 12px;
}

.meta-item {
  display: flex;
  align-items: center;
  gap: 4px;
}

.application-description {
  margin-bottom: 12px;
  color: #333;
  line-height: 1.5;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.application-stats {
  display: flex;
  gap: 16px;
  margin-bottom: 12px;
  font-size: 12px;
}

.stat-item {
  display: flex;
  gap: 4px;
}

.stat-label {
  color: #666;
}

.stat-value {
  font-weight: 500;
}

.text-success {
  color: #52c41a;
}

.text-error {
  color: #ff4d4f;
}

.text-warning {
  color: #faad14;
}

.text-info {
  color: #1890ff;
}

.application-actions {
  display: flex;
  gap: 8px;
}

.status-active {
  border-left: 4px solid #52c41a;
}

.status-inactive {
  border-left: 4px solid #d9d9d9;
}

.status-archived {
  border-left: 4px solid #faad14;
}
</style>
```

#### 物料管理组件

```vue
<!-- components/Verto/MaterialCard.vue -->
<template>
  <j-card 
    :title="material.materialName"
    :bordered="false"
    class="material-card"
    :class="`type-${material.materialType}`"
  >
    <template #extra>
      <div class="card-extra">
        <j-tag :color="getTypeColor(material.materialType)">
          {{ getTypeText(material.materialType) }}
        </j-tag>
        <span class="version">v{{ material.version }}</span>
      </div>
    </template>

    <div class="material-content">
      <div class="material-meta">
        <span class="meta-item">
          <UserOutlined />
          {{ material.authorName || '未知作者' }}
        </span>
        <span class="meta-item">
          <TagOutlined />
          {{ material.category }}
        </span>
        <span class="meta-item">
          <DownloadOutlined />
          {{ material.downloadCount || 0 }}
        </span>
        <span class="meta-item">
          <StarOutlined />
          {{ material.starCount || 0 }}
        </span>
      </div>

      <div class="material-description">
        {{ material.description || '暂无描述' }}
      </div>

      <div class="material-tags" v-if="material.tags">
        <j-tag 
          v-for="tag in getTags(material.tags)" 
          :key="tag"
          size="small"
        >
          {{ tag }}
        </j-tag>
      </div>

      <div class="material-actions">
        <j-button 
          type="link" 
          size="small"
          @click="viewDetail"
        >
          查看详情
        </j-button>
        
        <j-button 
          v-if="material.previewUrl"
          type="link" 
          size="small"
          @click="preview"
        >
          预览
        </j-button>
        
        <j-button 
          type="link" 
          size="small"
          @click="download"
          :loading="downloadLoading"
        >
          下载
        </j-button>
        
        <j-button 
          type="link" 
          size="small"
          @click="toggleStar"
          :class="{ 'starred': isStarred }"
        >
          <StarOutlined v-if="isStarred" />
          <StarTwoTone v-else />
          {{ isStarred ? '已收藏' : '收藏' }}
        </j-button>
      </div>
    </div>
  </j-card>
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'
import { useRouter } from 'vue-router'
import { useMessage } from '/@/hooks/web/useMessage'
import { 
  UserOutlined, 
  TagOutlined, 
  DownloadOutlined, 
  StarOutlined,
  StarTwoTone 
} from '@ant-design/icons-vue'
import { useMaterialStore } from '@/stores/modules/material'
import type { Material } from '@/types/verto/material'

interface Props {
  material: Material
}

const props = defineProps<Props>()
const router = useRouter()
const materialStore = useMaterialStore()
const { createMessage } = useMessage()
const downloadLoading = ref(false)
const isStarred = ref(false) // 这里应该从用户收藏状态获取

// 类型颜色映射
const typeColorMap = {
  component: 'blue',
  template: 'green',
  page: 'orange'
}

// 类型文本映射
const typeTextMap = {
  component: '组件',
  template: '模板',
  page: '页面'
}

const getTypeColor = (type: string) => typeColorMap[type] || 'default'
const getTypeText = (type: string) => typeTextMap[type] || type

// 解析标签
const getTags = (tags: string) => {
  return tags ? tags.split(',').filter(tag => tag.trim()) : []
}

// 查看详情
const viewDetail = () => {
  router.push(`/verto/material/detail/${props.material.id}`)
}

// 预览
const preview = () => {
  if (props.material.previewUrl) {
    window.open(props.material.previewUrl, '_blank')
  } else {
    createMessage.warning('暂无预览地址')
  }
}

// 下载
const download = async () => {
  downloadLoading.value = true
  try {
    createMessage.loading('正在下载物料...', 1)
    await materialStore.downloadMaterial(props.material.id)
    createMessage.success('下载成功')
  } catch (error) {
    createMessage.error('下载失败')
  } finally {
    downloadLoading.value = false
  }
}

// 切换收藏状态
const toggleStar = async () => {
  try {
    if (isStarred.value) {
      await materialStore.unstarMaterial(props.material.id)
      createMessage.success('已取消收藏')
    } else {
      await materialStore.starMaterial(props.material.id)
      createMessage.success('收藏成功')
    }
    isStarred.value = !isStarred.value
  } catch (error) {
    createMessage.error('操作失败')
  }
}
</script>

<style scoped>
.material-card {
  margin-bottom: 16px;
  transition: all 0.3s;
}

.material-card:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.card-extra {
  display: flex;
  align-items: center;
  gap: 8px;
}

.version {
  font-size: 12px;
  color: #666;
  background: #f5f5f5;
  padding: 2px 6px;
  border-radius: 4px;
}

.material-content {
  padding: 8px 0;
}

.material-meta {
  display: flex;
  gap: 16px;
  margin-bottom: 12px;
  color: #666;
  font-size: 12px;
}

.meta-item {
  display: flex;
  align-items: center;
  gap: 4px;
}

.material-description {
  margin-bottom: 12px;
  color: #333;
  line-height: 1.5;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.material-tags {
  margin-bottom: 12px;
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
}

.material-actions {
  display: flex;
  gap: 8px;
}

.starred {
  color: #faad14;
}

.type-component {
  border-left: 4px solid #1890ff;
}

.type-template {
  border-left: 4px solid #52c41a;
}

.type-page {
  border-left: 4px solid #faad14;
}
</style>
```

#### 人员管理组件

```vue
<!-- components/Verto/PersonnelTable.vue -->
<template>
  <div class="personnel-table">
    <BasicTable
      @register="registerTable"
      :searchInfo="searchInfo"
      :rowSelection="{ type: 'checkbox', selectedRowKeys: checkedKeys, onChange: onSelectChange }"
    >
      <template #tableTitle>
        <a-button
          type="primary"
          @click="handleAdd"
          preIcon="ant-design:plus-outlined"
        >
          新增人员
        </a-button>
        <a-button
          type="primary"
          @click="handleImport"
          preIcon="ant-design:import-outlined"
        >
          批量导入
        </a-button>
      </template>
      
      <template #avatar="{ record }">
        <a-avatar :src="record.avatar" :size="32">
          {{ record.realName?.charAt(0) }}
        </a-avatar>
      </template>
      
      <template #skills="{ record }">
        <j-tag 
          v-for="skill in getSkills(record.skills)" 
          :key="skill"
          size="small"
          color="blue"
        >
          {{ skill }}
        </j-tag>
      </template>
      
      <template #status="{ record }">
        <j-tag :color="getStatusColor(record.status)">
          {{ getStatusText(record.status) }}
        </j-tag>
      </template>
      
      <template #action="{ record }">
        <TableAction
          :actions="[
            {
              icon: 'clarity:note-edit-line',
              tooltip: '编辑人员',
              onClick: handleEdit.bind(null, record),
            },
            {
              icon: 'ant-design:eye-outlined',
              tooltip: '查看详情',
              onClick: handleDetail.bind(null, record),
            },
            {
              icon: 'ant-design:user-switch-outlined',
              tooltip: '分配项目',
              onClick: handleAssign.bind(null, record),
            },
          ]"
          :dropDownActions="[
            {
              label: '重置密码',
              icon: 'ant-design:key-outlined',
              onClick: handleResetPassword.bind(null, record),
            },
            {
              label: '删除',
              icon: 'ant-design:delete-outlined',
              color: 'error',
              popConfirm: {
                title: '是否确认删除',
                confirm: handleDelete.bind(null, record),
              },
            },
          ]"
        />
      </template>
    </BasicTable>
    
    <PersonnelModal @register="registerModal" @success="handleSuccess" />
    <AssignProjectModal @register="registerAssignModal" @success="handleSuccess" />
  </div>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue'
import { BasicTable, useTable, TableAction } from '/@/components/Table'
import { useModal } from '/@/components/Modal'
import { useMessage } from '/@/hooks/web/useMessage'
import PersonnelModal from './PersonnelModal.vue'
import AssignProjectModal from './AssignProjectModal.vue'
import { columns, searchFormSchema } from './personnel.data'
import { getPersonnelList, deletePersonnel, resetPassword } from '/@/api/verto/personnel'

const { createMessage } = useMessage()
const checkedKeys = ref<Array<string | number>>([])

const [registerTable, { reload }] = useTable({
  title: '人员列表',
  api: getPersonnelList,
  rowKey: 'id',
  columns,
  formConfig: {
    labelWidth: 120,
    schemas: searchFormSchema,
    autoSubmitOnEnter: true,
  },
  useSearchForm: true,
  showTableSetting: true,
  bordered: true,
  actionColumn: {
    width: 160,
    title: '操作',
    dataIndex: 'action',
    slots: { customRender: 'action' },
  },
})

const [registerModal, { openModal }] = useModal()
const [registerAssignModal, { openModal: openAssignModal }] = useModal()

const searchInfo = reactive<Recordable>({})

// 解析技能标签
function getSkills(skills: string) {
  return skills ? skills.split(',').filter(skill => skill.trim()) : []
}

// 状态颜色映射
function getStatusColor(status: string) {
  const colorMap = {
    active: 'success',
    inactive: 'default',
    leave: 'warning'
  }
  return colorMap[status] || 'default'
}

// 状态文本映射
function getStatusText(status: string) {
  const textMap = {
    active: '在职',
    inactive: '离职',
    leave: '请假'
  }
  return textMap[status] || status
}

function onSelectChange(selectedRowKeys: (string | number)[]) {
  checkedKeys.value = selectedRowKeys
}

function handleAdd() {
  openModal(true, {
    isUpdate: false,
  })
}

function handleEdit(record: Recordable) {
  openModal(true, {
    record,
    isUpdate: true,
  })
}

function handleDetail(record: Recordable) {
  // 跳转到详情页
  // router.push(`/verto/personnel/detail/${record.id}`)
}

function handleAssign(record: Recordable) {
  openAssignModal(true, {
    record,
  })
}

function handleDelete(record: Recordable) {
  deletePersonnel(record.id).then(() => {
    createMessage.success('删除成功')
    reload()
  })
}

function handleResetPassword(record: Recordable) {
  resetPassword(record.id).then(() => {
    createMessage.success('密码重置成功')
  })
}

function handleImport() {
  // 批量导入逻辑
  createMessage.info('批量导入功能开发中...')
}

function handleSuccess() {
  reload()
}
</script>
```

#### 数据配置文件

```typescript
// components/Verto/requirement.data.ts
import { BasicColumn } from '/@/components/Table'
import { FormSchema } from '/@/components/Table'
import { h } from 'vue'
import { Tag } from 'ant-design-vue'

export const columns: BasicColumn[] = [
  {
    title: '需求ID',
    dataIndex: 'zentaoId',
    width: 100,
    sorter: true,
  },
  {
    title: '需求标题',
    dataIndex: 'title',
    width: 200,
    ellipsis: true,
  },
  {
    title: '状态',
    dataIndex: 'status',
    width: 100,
    customRender: ({ record }) => {
      const statusMap = {
        pending: { color: 'orange', text: '待处理' },
        in_progress: { color: 'blue', text: '进行中' },
        completed: { color: 'green', text: '已完成' },
        rejected: { color: 'red', text: '已拒绝' }
      }
      const status = statusMap[record.status] || { color: 'default', text: record.status }
      return h(Tag, { color: status.color }, () => status.text)
    },
  },
  {
    title: '优先级',
    dataIndex: 'priority',
    width: 100,
    customRender: ({ record }) => {
      const priorityMap = {
        high: { color: 'red', text: '高' },
        medium: { color: 'orange', text: '中' },
        low: { color: 'green', text: '低' }
      }
      const priority = priorityMap[record.priority] || { color: 'default', text: record.priority }
      return h(Tag, { color: priority.color }, () => priority.text)
    },
  },
  {
    title: '负责人',
    dataIndex: 'assigneeName',
    width: 120,
  },
  {
    title: '创建时间',
    dataIndex: 'createTime',
    width: 150,
    sorter: true,
  },
]

export const searchFormSchema: FormSchema[] = [
  {
    field: 'title',
    label: '需求标题',
    component: 'Input',
    colProps: { span: 8 },
  },
  {
    field: 'status',
    label: '状态',
    component: 'Select',
    componentProps: {
      options: [
        { label: '待处理', value: 'pending' },
        { label: '进行中', value: 'in_progress' },
        { label: '已完成', value: 'completed' },
        { label: '已拒绝', value: 'rejected' },
      ],
    },
    colProps: { span: 8 },
  },
  {
    field: 'priority',
    label: '优先级',
    component: 'Select',
    componentProps: {
      options: [
        { label: '高', value: 'high' },
        { label: '中', value: 'medium' },
        { label: '低', value: 'low' },
      ],
    },
    colProps: { span: 8 },
  },
]

export const formSchema: FormSchema[] = [
  {
    field: 'zentaoId',
    label: '禅道ID',
    component: 'Input',
    required: true,
  },
  {
    field: 'title',
    label: '需求标题',
    component: 'Input',
    required: true,
  },
  {
    field: 'description',
    label: '需求描述',
    component: 'InputTextArea',
    componentProps: {
      rows: 4,
    },
  },
  {
    field: 'priority',
    label: '优先级',
    component: 'Select',
    componentProps: {
      options: [
        { label: '高', value: 'high' },
        { label: '中', value: 'medium' },
        { label: '低', value: 'low' },
      ],
    },
    required: true,
  },
  {
    field: 'assigneeId',
    label: '负责人',
    component: 'ApiSelect',
    componentProps: {
      api: () => import('/@/api/verto/personnel').then(m => m.getPersonnelOptions()),
      labelField: 'realName',
      valueField: 'id',
    },
  },
  {
    field: 'estimatedHours',
    label: '预估工时',
    component: 'InputNumber',
    componentProps: {
      min: 0,
      precision: 1,
    },
  },
]
```

### 4.4 路由配置

```typescript
// router/modules/verto.ts
import type { RouteRecordRaw } from 'vue-router'

const vertoRoutes: RouteRecordRaw[] = [
  {
    path: '/verto',
    name: 'Verto',
    component: () => import('@/layouts/default/index.vue'),
    meta: {
      title: '项目管理',
      icon: 'ProjectOutlined',
      orderNo: 100
    },
    children: [
      {
        path: 'dashboard',
        name: 'VertoDashboard',
        component: () => import('@/views/verto/dashboard/index.vue'),
        meta: {
          title: '工作台',
          icon: 'DashboardOutlined'
        }
      },
      {
        path: 'requirement',
        name: 'VertoRequirement',
        meta: {
          title: '需求管理',
          icon: 'FileTextOutlined'
        },
        children: [
          {
            path: 'list',
            name: 'RequirementList',
            component: () => import('@/views/verto/requirement/RequirementList.vue'),
            meta: {
              title: '需求列表'
            }
          },
          {
            path: 'detail/:id',
            name: 'RequirementDetail',
            component: () => import('@/views/verto/requirement/RequirementDetail.vue'),
            meta: {
              title: '需求详情',
              hideMenu: true
            }
          }
        ]
      },
      {
        path: 'application',
        name: 'VertoApplication',
        meta: {
          title: '应用管理',
          icon: 'AppstoreOutlined'
        },
        children: [
          {
            path: 'list',
            name: 'ApplicationList',
            component: () => import('@/views/verto/application/ApplicationList.vue'),
            meta: {
              title: '应用列表'
            }
          },
          {
            path: 'detail/:id',
            name: 'ApplicationDetail',
            component: () => import('@/views/verto/application/ApplicationDetail.vue'),
            meta: {
              title: '应用详情',
              hideMenu: true
            }
          }
        ]
      },
      {
        path: 'material',
        name: 'VertoMaterial',
        meta: {
          title: '物料管理',
          icon: 'BlockOutlined'
        },
        children: [
          {
            path: 'registry',
            name: 'MaterialRegistry',
            component: () => import('@/views/verto/material/MaterialRegistry.vue'),
            meta: {
              title: '物料注册表'
            }
          },
          {
            path: 'detail/:id',
            name: 'MaterialDetail',
            component: () => import('@/views/verto/material/MaterialDetail.vue'),
            meta: {
              title: '物料详情',
              hideMenu: true
            }
          }
        ]
      },
      {
        path: 'personnel',
        name: 'VertoPersonnel',
        meta: {
          title: '人员管理',
          icon: 'TeamOutlined'
        },
        children: [
          {
            path: 'list',
            name: 'PersonnelList',
            component: () => import('@/views/verto/personnel/PersonnelList.vue'),
            meta: {
              title: '人员列表'
            }
          },
          {
            path: 'timesheet',
            name: 'PersonnelTimesheet',
            component: () => import('@/views/verto/personnel/PersonnelTimesheet.vue'),
            meta: {
              title: '工时统计'
            }
          }
        ]
      }
    ]
  }
]

export default vertoRoutes
```

---

## 五、安全设计

### 5.1 认证授权

1. **JWT Token认证**
   - 使用JeecgBoot现有的JWT认证机制
   - Token过期时间设置为2小时
   - 支持Token刷新机制

2. **权限控制**
   - 基于RBAC模型的权限管理
   - 接口级权限控制
   - 数据级权限控制

3. **API安全**
   - 接口限流：每分钟最多100次请求
   - 参数校验：使用Hibernate Validator
   - SQL注入防护：使用MyBatis Plus预编译

### 5.2 数据安全

1. **敏感数据加密**
   - 密码使用BCrypt加密
   - API密钥使用AES加密存储
   - 传输过程使用HTTPS

2. **数据脱敏**
   - 日志中敏感信息脱敏
   - 接口返回数据脱敏
   - 数据导出脱敏

3. **审计日志**
   - 操作日志记录
   - 登录日志记录
   - 数据变更日志

---

## 六、性能优化

### 6.1 后端优化

1. **数据库优化**
   - 合理设计索引
   - 分页查询优化
   - 慢查询监控

2. **缓存策略**
   - Redis缓存热点数据
   - 查询结果缓存
   - 分布式缓存

3. **异步处理**
   - 文件上传异步处理
   - 邮件发送异步处理
   - 数据同步异步处理

### 6.2 前端优化

1. **代码分割**
   - 路由级代码分割
   - 组件级懒加载
   - 第三方库按需加载

2. **资源优化**
   - 图片懒加载
   - 图片压缩
   - CDN加速

3. **渲染优化**
   - 虚拟滚动
   - 防抖节流
   - 组件缓存

---

## 七、监控告警

### 7.1 应用监控

1. **性能监控**
   - 接口响应时间
   - 系统资源使用率
   - 数据库连接池状态

2. **错误监控**
   - 异常日志收集
   - 错误率统计
   - 错误告警

3. **业务监控**
   - 用户行为统计
   - 功能使用情况
   - 数据同步状态

### 7.2 告警机制

1. **告警规则**
   - 接口错误率>5%
   - 响应时间>3秒
   - 系统资源使用率>80%

2. **告警方式**
   - 邮件告警
   - 短信告警
   - 钉钉群告警

---

## 八、部署方案

### 8.1 容器化部署

```dockerfile
# Dockerfile for backend
FROM openjdk:11-jre-slim

VOLUME /tmp
COPY target/jeecg-boot-module-system-3.5.3.jar app.jar

EXPOSE 8080

ENTRYPOINT ["java","-jar","/app.jar"]
```

```dockerfile
# Dockerfile for frontend
FROM node:16-alpine as builder

WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/nginx.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

### 8.2 Docker Compose配置

```yaml
version: '3.8'

services:
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: jeecg-boot
    volumes:
      - mysql_data:/var/lib/mysql
    ports:
      - "3306:3306"

  redis:
    image: redis:6-alpine
    ports:
      - "6379:6379"

  minio:
    image: minio/minio
    environment:
      MINIO_ACCESS_KEY: minioadmin
      MINIO_SECRET_KEY: minioadmin
    volumes:
      - minio_data:/data
    ports:
      - "9000:9000"
      - "9001:9001"
    command: server /data --console-address ":9001"

  backend:
    build: .
    environment:
      SPRING_PROFILES_ACTIVE: prod
      SPRING_DATASOURCE_URL: jdbc:mysql://mysql:3306/jeecg-boot
      SPRING_REDIS_HOST: redis
    depends_on:
      - mysql
      - redis
      - minio
    ports:
      - "8080:8080"

  frontend:
    build: ./jeecgboot-vue3
    ports:
      - "80:80"
    depends_on:
      - backend

volumes:
  mysql_data:
  minio_data:
```

---

**文档维护**：技术团队  
**最后更新**：2025-01-18  

*本文档将随着项目开发进展持续更新和完善。*