# 需求设计文档

# 前端项目管理平台 — 需求设计文档

​**版本**：v0.1  
​**日期**：2025-09-18  
​**作者**：产品 / 技术

---

## 一、文档目的

本文档旨在对“前端项目管理平台”进行需求层面的完整设计说明，覆盖功能模块、流程、集成点、数据模型、非功能需求以及验收标准，作为产品开发与研发实现的基线规范。

## 二、项目背景与范围

​**背景**：为提升前端项目从需求到交付的效率和质量，构建一套以需求联动、Git 为中心、模块化物料复用与人员知识沉淀为核心的前端项目管理平台。

​**范围（高层）** ：

- 需求管理（与禅道联动、原型编辑、SRS 生成与上传）
- 应用管理（以 GitLab 仓库为中心，关联 Jenkins、Matomo、构建与自动测试）
- 物料管理（模块联邦管理组件与页面模板、在线预览、AI 辅助生成）
- 人员管理（人员分布、入职指南、交接文档、工时统计）

## 三、主要参与者（Stakeholders）

- 产品经理：提出需求并维护需求状态
- 开发工程师：实现需求、创建分支与提交代码
- 测试工程师：关联测试用例与缺陷
- 研发管理 / PMO：审批、里程碑管理
- 运维/CI 管理员：配置流水线与部署
- 所有平台用户：查看/协作/上传文档

## 四、总体架构概览（文字描述）

平台分四个主模块（需求管理、应用管理、物料管理、人员管理），以 ​**身份认证与权限中心**、​**文档管理系统confluence**、**GitLab / Jenkins / Matomo / 禅道** 等外部系统作为横向集成。核心流程为：禅道需求 → 平台需求卡片（补充原型/UI）→ 生成分支 → 开发/CI 流水线 → 自动测试/构建分析 → 发布 / 文档归档。

---

## 五、功能需求（按模块细化，均包含示例验收条件）

### 5.1 需求管理（REQ）

​**目标**：实现禅道联动、原型到代码的闭环、自动化生成需求规格说明书并归档。

#### 功能项

- **REQ-001：禅道对接与需求同步**

  - 描述：支持通过 API 或 Webhook或者其他方式 从禅道（Zentao）同步需求（拉取新需求，获取需求的状态，并且支持建立提醒任务）。
  - 关键字段：zentao\_id、title、description、priority、status、assignee、created\_at、updated\_at、attachments。
  - 验收：新禅道需求在平台中能被检索并显示字段；禅道需求状态变更时可以接收到提醒状态。
- **REQ-002：需求卡片与详情**

  - 描述：在平台内显示需求卡（列表/看板/详情），支持补充原型文件、UI 截图、关联应用和备注。
  - 验收：能够为某禅道需求添加原型附件、输入应用地址并在详情页展示。
- **REQ-003：原型编辑 — Pencil 二次开发集成**

  - 描述：集成或扩展 Pencil，让用户可以直接在平台里打开 Pencil 编辑原型；支持导出/保存为平台兼容的 schema（建议：Ant Design Pro page.json）。
  - 验收：用户在需求详情点击“编辑原型”能打开 Pencil 编辑器，保存后生成 page.json 并能够在平台预览页面结构。
- **REQ-004：原型 → 页面 Schema 的转换**

  - 描述：提供 Pencil 到 Ant Design Pro `page.json` 的转换器/导出器（可为 Pencil 插件或独立转换服务），支持常见组件映射（表单、表格、按钮等）。
  - 验收：原型导出后生成合理的 page.json（结构正确，包含路由、组件占位信息）。
- **REQ-005：创建 Git 分支（自动化）**

  - 描述：在需求详情页支持“一键创建分支”，平台调用 GitLab API 创建分支，并返回分支链接。分支命名规则可配置（示例：`feature/zentao-{id}-{short-title}`）。
  - 验收：创建后能在 GitLab 上看到新分支，并将分支信息关联回需求卡片。
- **REQ-006：打开/链接编辑器**

  - 描述：支持通过 Deep Link 或 Remote IDE（例如 Theia / VSCode Remote）打开对应分支的仓库或文件位置，或提供内置在线编辑器链接（若实现）。
  - 验收：点击“打开编辑器”能将开发者引导到正确的仓库分支与路径（或给出可供复制的命令/链接）。
- **REQ-007：需求规格说明书（SRS）生成**

  - 描述：从需求卡片（含原型、UI、关联应用、验收条件）自动生成格式化的SRS（支持 Markdown / Word / PDF 导出）。
  - 验收：生成的 SRS 包含需求描述、用例、原型截图、关联分支与责任人，导出为 Markdown/Word /PDF文件并可下载。
- **REQ-008：自动上传 SRS 到文档管理系统**

  - 描述：在 SRS 生成后自动将文件上传至企业文档管理系统Confluence，并将文档链接回写到需求详情。
  - 验收：上传成功并在需求详情显示文档管理系统的链接与元数据（文档ID、上传时间、版本）。
- **REQ-009：需求与应用/UI 的双向关联**

  - 描述：在需求里能关联目标应用（由应用管理模块维护），并记录具体应用地址/菜单项；反之，在应用管理中能查询关联需求。
  - 验收：在需求详情能点击跳转至关联应用的页面管理视图并看到需求列表。
- **REQ-010：版本与变更审计**

  - 描述：记录需求的全量变更历史（谁在何时修改了哪些字段）、原型版本、SRS 版本。
  - 验收：在需求详情能通过历史记录查看并回滚（若允许）到某个历史版本。
- **REQ-011：权限控制**

  - 描述：基于人员管理的角色权限，控制谁可以同步禅道、创建分支、生成 SRS、上传文档等敏感操作。
  - 验收：权限校验生效，普通开发不可执行管理员权限操作。
- **REQ-012：导出/协作功能**

  - 描述：支持导出需求包（包含 SRS、原型、附件）便于离线评审；支持评论/审批流程（可结合审批工作流）。
  - 验收：能导出 ZIP 包，且评论与审批记录保留。

### 5.2 应用管理（APP）

​**目标**：以 GitLab 仓库为中心管理应用的配置、构建、埋点与测试。

#### 功能项

- **APP-001：GitLab 仓库登记与同步**

  - 描述：登记仓库地址、主分支策略、Webhook 设置；平台可拉取仓库基本信息（仓库描述、权限、分支列表）。
  - 验收：仓库登记后能看到分支列表与最近提交记录。
- **APP-002：Jenkins 流水线关联**

  - 描述：为每个应用配置 Jenkins 流水线，支持一键触发、查看流水线状态与日志。支持 Pipeline Status 回写到平台。
  - 验收：能在平台触发 Jenkins Job 并查看执行日志与状态。
- **APP-003：应用菜单与权限映射**

  - 描述：在平台维护应用菜单（路由）信息，并将菜单项与权限策略关联（按角色/用户）。
  - 验收：菜单权限设置后，平台中不同角色看到的菜单项符合预期。
- **APP-004：埋点管理（Matomo）**

  - 描述：集成 Matomo，管理各应用的 tracking ID、事件定义、事件埋点文档，查看 PV/UV 与事件统计。支持将埋点事件与需求/页面关联。
  - 验收：在应用视图能看到 Matomo 的基本统计数据并能按照事件维度筛选。
- **APP-005：构建体积/依赖分析**

  - 描述：集成构建产物分析（基于 vite/webpack/rollup stats），展示包体积、依赖树与关键依赖增长趋势。
  - 验收：能展示最近若干次构建的 bundle size 对比与主要依赖占比。
- **APP-006：自动化测试集成**

  - 描述：集成单元测试与 E2E（如 Jest / Playwright / Cypress），展示测试覆盖率和 E2E 报告。支持在 CI 流水线中触发并回写结果。
  - 验收：测试结果在应用详情可查看，失败时能触发告警/任务。
- **APP-007：错误监控与性能告警**

  - 描述：与 Sentry / Prometheus 等监控工具集成，展示错误汇总与性能指标，支持订阅告警。
  - 验收：能展示近24小时错误趋势并接收告警通知。
- **APP-008：快速开发支持（Scaffold）**

  - 描述：基于 page.json（来自需求原型）一键生成项目页面 scaffolding 或 PR（可选），减少从原型到代码的门槛。
  - 验收：提交 PR 后包含自动生成的页面骨架，并与原型页能够对齐。

### 5.3 物料管理（MAT）

​**目标**：基于模块联邦实现组件与页面模版的版本化管理与远程加载。

#### 功能项

- **MAT-001：物料注册表（Registry）**

  - 描述：提供物料仓库（组件/页面/模板），记录版本、发布者、依赖、示例用法与预览地址。
  - 验收：能注册一个组件包并在 Registry 中检索到其版本与预览链接。
- **MAT-002：模块联邦支持与远程加载**

  - 描述：支持通过模块联邦（Module Federation）配置远程组件加载的元数据，便于不同应用在运行时动态引入组件/页面。
  - 验收：示例应用能在运行时加载远程组件并正确渲染。
- **MAT-003：模板库与固定模版**

  - 描述：内置常见页面模板（登录、表单、列表、仪表盘）供快速使用与自定义。模板支持参数化配置。
  - 验收：用户能在 UI 上选择模板并生成预览页面。
- **MAT-004：AI 辅助生成物料**

  - 描述：根据需求/原型自动生成页面或组件草稿（可作为 PR 提交至目标仓库）。
  - 验收：AI 生成的草稿能作为初版代码提交仓库并可手工迭代。
- **MAT-005：版本管理与依赖分析**

  - 描述：记录物料的版本历史与依赖树，支持回退版本与查看依赖冲突。
  - 验收：能回滚组件至历史版本且依赖提示准确。

### 5.4 人员管理（PEO）

​**目标**：记录团队分布、知识与交接信息，不包含成本计算。

#### 功能项

- **PEO-001：人员分布与技能矩阵**

  - 描述：展示项目/团队下各成员分布、角色、技能标签（如 React、Vue、测试、DevOps）。
  - 验收：能按项目/技能筛选人员并导出 CSV。
- **PEO-002：入职指南管理**

  - 描述：为每个项目维护入职指南（环境搭建、代码规范、常用命令、联系方式）。
  - 验收：新成员能通过入职指南完成本地环境搭建的验证步骤。
- **PEO-003：人员交接文档**

  - 描述：支持离职/转岗人员填写交接清单并上传相关文档，关联到相关代码/需求/物料。
  - 验收：交接完成后，接手人能查看全部交接记录与附件。
- **PEO-004：工时统计导出**

  - 描述：支持按日/周/项目导出工时统计（Excel/CSV），用于进度分析（不做财务/成本计算）。
  - 验收：能导出选定时间范围的工时明细表。

---

## 六、数据模型（简要）

主要实体及关键字段（示例）：

- **Requirement**

  ```json
  {
    "id": "REQ-1001",
    "zentao_id": 12345,
    "title": "用户登录优化",
    "description": "...",
    "status": "open",
    "assignee": "zhangsan",
    "prototype_page_json": {},
    "srs_doc": {"doc_id":"DOC-123","url":"..."},
    "related_app_id": "APP-001",
    "created_at": "2025-09-18T08:00:00Z",
    "updated_at": "..."
  }
  ```
- ​**Application**（简要）

  - id, name, gitlab\_repo, jenkins\_job, matomo\_site\_id, menus
- **Material / Component**

  - id, name, type(component/page/template), versions[], remote\_entry(url), dependencies
- **User / Role**

  - id, username, email, roles[], skills[], projects[]
- **TimesheetEntry**

  - user\_id, date, hours, task\_id, project\_id

---

## 七、接口与集成点（示例）

> 说明：以下仅为 API 交互示例，实际实现时需与目标系统（禅道/GitLab/Jenkins/Matomo/文档管理）对接并完善认证与错误处理。

- **同步禅道需求（被动）**

  - ​`POST /api/integrations/zentao/webhook`​
  - 载荷：zentao 变更数据
- **手动拉取禅道需求**

  - ​`POST /api/zentao/sync` {"project\_id":123}
- **创建 Git 分支**

  - ​`POST /api/apps/{app_id}/branches`​
  - 载荷示例：

    ```json
    { "branch_name": "feature/zentao-12345-login-improve", "from": "develop" }
    ```
- **生成并上传 SRS**

  - ​`POST /api/requirements/{id}/generate-srs`  返回 SRS 文件并调用文档管理上传接口
- **调用 Pencil 导出转换服务**

  - ​`POST /api/prototypes/convert` {"pencil\_file\_url":"...", "target":"page.json"}

---

## 八、UI/UX 要点（建议）

- 需求详情页采用卡片化布局：左侧需求元数据，右侧原型预览 + SRS 版本历史；顶部操作栏放“创建分支/编辑原型/生成 SRS”。
- 应用管理页面以仓库为主卡片，展示 pipeline 状态、最近构建、Matomo 摘要与构建体积概览。
- 物料库提供搜索、标签、版本过滤和在线预览面板。
- 人员管理页面支持技能筛选、导出和交接流程入口。

---

## 九、权限设计（高层）

- ​**角色示例**：Administrator / ProductManager / Developer / Tester / Viewer
- ​**权限粒度**：模块级（能否访问）、操作级（能否创建分支/同步禅道/上传文档）与数据级（只能见所在项目数据）。
- ​**认证**：建议支持 SSO（OAuth2 / LDAP），并在平台内维护角色映射。

---

## 十、非功能性需求（NFR）

- ​**可用性**：关键功能（需求详情、创建分支、SRS 生成）可用率目标 ≥ 99%。
- ​**性能**：需求详情页面响应时间 \< 1s（冷缓存情况下 \< 2s）。
- ​**扩展性**：支持水平扩展，物料库可按命名空间分片。
- ​**安全**：接口需鉴权，文件上传需病毒扫描/大小限制，敏感操作须审计日志。
- ​**合规**：文档存储与日志保留策略按公司合规要求执行。

---

## 十一、验收标准（每个模块示例）

- ​**需求管理 MVP 验收**：能从禅道拉取需求、在需求详情中补充原型、能创建 Git 分支并在 GitLab 上可见、能生成 SRS 并下载。
- ​**应用管理 MVP 验收**：能登记 GitLab 仓库、触发并查看 Jenkins Job、Matomo site ID 配置并展示基础统计。
- ​**物料管理 MVP 验收**：能注册组件并进行在线预览，支持模块联邦示例加载。
- ​**人员管理 MVP 验收**：能展示人员分布并导出工时表，能够上传并保存交接文档。

---

## 十二、实施分阶段建议（按优先级分功能集）

> 说明：下面按功能先后列出建议的开发迭代（不含时间估算）。

- ​**Phase A（MVP 核心）** ：禅道同步基础、需求卡片、创建分支（GitLab 集成）、SRS 生成与导出、应用登记（GitLab）、人员基本展示。
- ​**Phase B（联动增强）** ：Pencil 集成与 page.json 转换、Jenkins 关联、Matomo 基础接入、物料 Registry 基本功能。
- ​**Phase C（自动化与智能）** ：快速开发 Scaffold、CI/CD 深度回写、构建体积分析、AI 辅助物料生成、权限细化与审计。

---

## 十三、风险与假设

- ​**假设**：禅道/GitLab/Jenkins/文档管理系统都提供可用 API 与权限；团队有权限配置 Webhook/Token。
- ​**风险**：第三方系统 API 变更或权限限制会影响同步；Pencil 二次开发需要评估开源许可与可扩展性；AI 生成质量需要人工把关。

---

## 十四、后续可交付项（供产品/工程后续推进）

1. 细化需求管理的 API 规范与消息队列设计（事件模型）
2. Pencil 到 page.json 的映射表与示例转换器实现方案
3. GitLab / Jenkins / Matomo / 禅道 的接入脚本与权限配置手册
4. 物料 Registry 的数据库 ER 及模块联邦示例 Repo
5. 完整的验收测试用例（自动化）

---

如需我把上面的 SRS 模板自动化为可下载的 Word/PDF，或把某一模块（例如 Pencil 集成或 Git 分支流程）进一步拆成用户故事与接口细节，我可以继续帮你细化。
