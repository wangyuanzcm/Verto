# 技术实现方案

## 1. 项目背景与目标

本项目旨在建设一个 ​**前端项目管理平台（桌面客户端）** ，集成需求管理、应用管理、物料管理、人员管理四大核心模块，结合 **Git、Jenkins、禅道、Confluence、模块联邦、Pencil、Playwright** 等工具，实现需求到交付的全流程管理。

特点：

- 前端开发人员友好，尽量减少后端依赖。
- 采用 ​**Electron 桌面客户端**，支持 ​**Windows / macOS**。
- 数据集中存储到后端服务，支持权限管理和多用户协作。
- 对接企业现有工具链（禅道、Confluence、GitLab、Jenkins）。

---

## 2. 系统架构设计

### 2.1 整体架构

```
┌─────────────────────────────────────────────┐
│                 Electron 客户端             │
│   ┌─────────────┐   ┌───────────────────┐  │
│   │ 前端 (Vue3) │←→│ 本地 Node 服务层   │  │
│   └─────────────┘   └───────────────────┘  │
│          │ HTTP/gRPC/IPC                   │
└──────────┼─────────────────────────────────┘
           │
           ▼
┌─────────────────────────────────────────────┐
│              后端服务 (NestJS/Express)      │
│ - 用户权限管理 (RBAC)                        │
│ - 数据存储 (PostgreSQL/MySQL)                │
│ - API 网关                                   │
└─────────────────────────────────────────────┘
           │
           ▼
┌─────────────────────────────────────────────┐
│ 外部系统集成：                               │
│ - GitLab / GitHub                            │
│ - Jenkins                                    │
│ - 禅道 (需求/状态爬取)                        │
│ - Confluence (5.10.8，本地文档上传/导出)     │
│ - Matomo (埋点分析)                          │
└─────────────────────────────────────────────┘
```

### 2.2 技术栈

- ​**前端**：Vue3 + Vite + Ant Design Vue / Element Plus
- ​**桌面客户端**：Electron + Node.js
- ​**后端服务**：NestJS / Express + TypeORM + PostgreSQL/MySQL
- ​**自动化/爬虫**：Playwright
- ​**文档处理**：python-docx（需求规格说明书导出 Word）
- ​**模块联邦**：webpack5 + [module-federation.io](https://module-federation.io/)
- ​**埋点分析**：Matomo

---

## 3. 功能模块设计

### 3.1 需求管理

- 对接禅道：获取需求、需求状态
- 需求关联：

  - 原型（Pencil 二次开发）
  - 应用地址
  - 需求的 UI
- 自动化功能：

  - 创建 Git 分支
  - 打开本地编辑器（VSCode/WebStorm）
- 输出：

  - 自动生成 **需求规格说明书（SRS）**
  - 上传至 Confluence 文档库

### 3.2 应用管理

- GitLab 仓库配置（API 交互）
- Jenkins 流水线绑定
- 应用菜单、权限配置
- 快速开发脚手架（生成基础页面/组件）
- 埋点（Matomo SDK 集成）
- 构建分析（Webpack/Bundle 分析器）
- 自动化测试（Playwright）

### 3.3 物料管理

- 模块联邦（跨应用共享组件/页面）
- 物料类型：

  - UI 组件库
  - 页面模板
  - 固定业务模块
- 在线预览与版本管理

### 3.4 人员管理

- 开发人员分布信息
- 入职指南、交接文档（关联 Confluence）
- 工时统计与导出

---

## 4. 核心功能实现方案

### 4.1 Git 分支管理

- 通过 Git CLI 命令在 Electron 内部执行：

  ```bash
  git checkout -b feature/需求编号-标题
  ```
- 支持 GitLab API 获取 MR/分支信息

### 4.2 禅道需求同步

- ​**不通过 API**：  
  使用 **Playwright 爬虫**模拟登录禅道，抓取需求数据与状态。
- 数据存储到后端数据库，周期性同步。

### 4.3 Confluence 文档管理

- ​**不通过 API 上传**：  
  方案 1：在客户端生成 Word → 用户上传至 Confluence  
  方案 2：自动化操作（Playwright 模拟上传）

### 4.4 Pencil 原型二次开发

- 定制化 ​**schema 导出**：支持生成 Ant Design Pro 的 `page.json`​
- 与需求关联：原型与 Git 分支、UI、需求说明书联动
- 支持一键导出原型文档，上传至 Confluence

### 4.5 Word 导出方案

- 使用 **python-docx** 生成规范化 Word 文档
- 文档模板：符合 SRS 标准（需求背景、用例、界面设计、接口等）
- 导出文件命名规则：`需求编号-需求标题.docx`​

### 4.6 模块联邦物料管理

- 使用 ​**Module Federation**：

  - 组件库统一暴露入口
  - 页面按需加载
  - 跨应用共享运行时
- Electron 内嵌微前端应用

---

## 5. 权限与用户体系

### 5.1 登录认证

- 使用 **JWT + Refresh Token**
- 登录方式：用户名密码 / 企业 LDAP

### 5.2 权限模型

- RBAC（基于角色的访问控制）
- 用户 → 角色 → 权限点（页面、按钮、API）
- 细粒度：应用管理、需求编辑、文档上传、测试执行

---

## 6. 部署与运维方案

- ​**客户端**：Electron 打包（Windows EXE + macOS DMG）
- ​**后端服务**：Docker 部署（NestJS + PostgreSQL/MySQL）
- ​**CI/CD**：GitLab CI + Jenkins 自动化构建
- ​**日志与监控**：

  - Electron 端：Sentry 收集报错
  - 后端：Prometheus + Grafana

---

## 7. 扩展性与未来规划

- 接入更多原型工具（如 Figma、Axure）
- 支持在线代码生成（结合 AI 模型）
- 进一步自动化测试与性能监控
- 多组织/多租户支持

---

📌 以上是整理好的 ​**完整技术实现方案文档（Markdown 版）** 。  
要不要我帮你把 **需求规格说明书（SRS）**  的 Word 模板也整理一份（python-docx 可以直接套用）？
